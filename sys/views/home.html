<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta charset="utf-8" />
    <title>{{title}}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no" />
    <link rel="apple-touch-icon" href="public/bolt/pages/pages/ico/60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="public/bolt/pages/pages/ico/76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="public/bolt/pages/pages/ico/120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="public/bolt/pages/pages/ico/152.png">
    <link rel="icon" type="image/x-icon" href="public/bolt/pages/pages/ico/favicon.ico" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta content="" name="description" />
    <meta content="" name="author" />
    <link href="public/bolt/pages/assets/plugins/pace/pace-theme-flash.css" rel="stylesheet" type="text/css" />
    <link href="public/bolt/pages/assets/plugins/bootstrapv3/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="public/bolt/pages/assets/plugins/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <link href="public/bolt/pages/assets/plugins/jquery-scrollbar/jquery.scrollbar.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="public/bolt/pages/assets/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="public/bolt/pages/assets/plugins/switchery/css/switchery.min.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="public/bolt/pages/pages/css/pages-icons.css" rel="stylesheet" type="text/css">
    <link class="main-stylesheet" href="public/bolt/pages/pages/css/pages.css" rel="stylesheet" type="text/css" />
    <!--[if lte IE 9]>
        <link href="public/bolt/pages/pages/css/ie9.css" rel="stylesheet" type="text/css" />
    <![endif]-->
    <script type="text/javascript">
    window.onload = function()
    {
      // fix for windows 8
      if (navigator.appVersion.indexOf("Windows NT 6.2") != -1)
        document.head.innerHTML += '<link rel="stylesheet" type="text/css" href="public/bolt/pages/pages/css/windows.chrome.fix.css" />'
    }
    </script>
  </head>
  <body class="fixed-header error-page">
    <div class="container-xs-height full-height">
      <div class="row-xs-height">
        <div class="col-xs-height col-middle">
          <div class="error-container text-center">
            <h1 class="error-number" id="username"></h1>
            <h1 class="error-number">No Home App</h1>
            <p>You have no <b>Home</b> app installed. You can download one online or sideload an already-downloaded copy.
            </p>
            <button class="btn btn-block btn-info btn-cons m-b-10" type="button" id="download">
                <i class="fa fa-cloud-download"></i> 
                <span class="bold">Download (from npm)</span>
            </button>
            <button class="btn btn-block btn-info btn-cons m-b-10" type="button" id="sideload">
                <i class="fa fa-copy"></i> 
                <span class="bold">Sideload (ensure it is first copied to the node_modules folder)</span>
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- END PAGE CONTAINER -->
    <!-- BEGIN VENDOR JS -->
    <script src="public/bolt/pages/assets/plugins/pace/pace.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/modernizr.custom.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/bootstrapv3/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery/jquery-easy.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-unveil/jquery.unveil.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-bez/jquery.bez.min.js"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-ios-list/jquery.ioslist.min.js" type="text/javascript"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-actual/jquery.actual.min.js"></script>
    <script src="public/bolt/pages/assets/plugins/jquery-scrollbar/jquery.scrollbar.min.js"></script>
    <script type="text/javascript" src="public/bolt/pages/assets/plugins/select2/js/select2.full.min.js"></script>
    <script type="text/javascript" src="public/bolt/pages/assets/plugins/classie/classie.js"></script>
    <script src="public/bolt/pages/assets/plugins/switchery/js/switchery.min.js" type="text/javascript"></script>
    <!-- END VENDOR JS -->
    <script src="public/bolt/pages/pages/js/pages.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            //get current user
            $.ajax({
              url: "{{protocol}}://{{host}}:{{port}}/api/users/@current",
              type: "GET",
              headers: {'X-Bolt-Req-Id': '{{reqid}}'},
              success: function(response, status, xhr){
                if(response.code == 0){
                  var user = response.body;
                  if(user) $("#username").html("Welcome " + user.displayName);
                }
                else {
                  //TODO: error
                  console.log(response);
                }
              },
              error: function(xhr, status, err){}
            });

            $("#download").click(function(){
                $.ajax({
                  url: "{{protocol}}://{{host}}:{{port}}/api/apps/get",
                  data: { name: "bolt-home" },
                  type: "POST",
                  headers: {'X-Bolt-Req-Id': '{{reqid}}'},
                  success: function(response, status, xhr){
                    if(response.code == 0){
                      window.location.href="{{protocol}}://{{host}}:{{port}}/Home";
                    }
                    else {
                      //TODO: error
                      console.log(response);
                    }
                  },
                  error: function(xhr, status, err){}
                });
            });

            $("#sideload").click(function(){
                $.ajax({
                  url: "{{protocol}}://{{host}}:{{port}}/api/apps/reg",
                  data: { path: "bolt-home" },
                  type: "POST",
                  headers: {'X-Bolt-Req-Id': '{{reqid}}'},
                  success: function(response, status, xhr){
                    if(response.code == 0){
                      window.location.href="{{protocol}}://{{host}}:{{port}}/Home";
                    }
                    else {
                      //TODO: error
                      console.log(response);
                    }
                  },
                  error: function(xhr, status, err){}
                });
            });
          });
    </script>
  </body>
</html>